{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet ProductosComponent = class ProductosComponent {\n  constructor(productoService, router, authService // Asegúrate de inyectar tu AuthService\n  ) {\n    this.productoService = productoService;\n    this.router = router;\n    this.authService = authService;\n    this.scrollPosition = 0;\n    this.productos = [];\n    this.newProducto = {};\n    this.editingProducto = null;\n    this.selectedFile = null;\n    this.error = '';\n    this.filter = '';\n    this.apiUrl = 'http://localhost:3000/api/productos';\n  }\n  ngOnInit() {\n    this.loadProductos();\n  }\n  loadProductos() {\n    this.productoService.getProductos().subscribe(data => {\n      this.productos = data;\n    }, err => {\n      console.error('Error obteniendo productos:', err);\n      this.error = 'Error en el servidor al obtener productos.';\n    });\n  }\n  isJavier() {\n    return this.authService.getCurrentUser() === 'javier';\n  }\n  onFileChange(event) {\n    const element = event.target;\n    if (element.files && element.files.length > 0) {\n      this.newProducto.imagen_pro = element.files[0];\n    }\n  }\n  createProducto() {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para crear productos');\n      return;\n    }\n    this.productoService.createProducto(this.newProducto).subscribe(data => {\n      this.productos.push(data);\n      this.newProducto = {};\n      this.router.navigate(['productos']);\n    }, err => {\n      console.error('Error creando producto:', err);\n      this.error = 'Error en el servidor al crear producto.';\n    });\n  }\n  editProducto(producto) {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para editar productos');\n      return;\n    }\n    this.editingProducto = {\n      ...producto\n    };\n  }\n  updateProducto(comp_id) {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para actualizar productos');\n      return;\n    }\n    if (this.selectedFile && !this.editingProducto.imagen_pro) {\n      this.productoService.uploadImagen(this.selectedFile).subscribe(response => {\n        this.editingProducto.imagen_pro = response.imageUrl;\n        this.saveUpdatedProducto(comp_id);\n      }, error => {\n        console.error('Error al cargar la imagen:', error);\n      });\n    } else {\n      this.saveUpdatedProducto(comp_id);\n    }\n  }\n  saveUpdatedProducto(comp_id) {\n    this.productoService.updateProducto(comp_id, this.editingProducto).subscribe(data => {\n      const index = this.productos.findIndex(p => p.comp_id === comp_id);\n      if (index !== -1) {\n        this.productos[index] = data;\n      }\n      this.editingProducto = null;\n    }, err => {\n      console.error('Error actualizando producto:', err);\n      this.error = 'Error en el servidor al actualizar producto.';\n    });\n  }\n  deleteProducto(id) {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para eliminar productos');\n      return;\n    }\n    if (id) {\n      this.productoService.deleteProducto(id).subscribe(data => {\n        this.productos = this.productos.filter(p => p.comp_id !== id);\n        this.router.navigate(['productos']);\n      }, err => {\n        console.error('Error eliminando producto:', err);\n        this.error = 'Error en el servidor al eliminar producto.';\n      });\n    } else {\n      console.error('No se encontró el producto:', id);\n    }\n  }\n};\nProductosComponent = __decorate([Component({\n  selector: 'app-productos',\n  templateUrl: './productos.component.html',\n  styleUrls: ['./productos.component.css']\n})], ProductosComponent);\nexport { ProductosComponent };","map":{"version":3,"names":["Component","ProductosComponent","constructor","productoService","router","authService","scrollPosition","productos","newProducto","editingProducto","selectedFile","error","filter","apiUrl","ngOnInit","loadProductos","getProductos","subscribe","data","err","console","isJavier","getCurrentUser","onFileChange","event","element","target","files","length","imagen_pro","createProducto","push","navigate","editProducto","producto","updateProducto","comp_id","uploadImagen","response","imageUrl","saveUpdatedProducto","index","findIndex","p","deleteProducto","id","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\980030881\\OneDrive\\Escritorio\\proyecto_web\\frontend\\componentes\\productos\\productos.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ProductoService } from 'src/app/services/producto.service';\nimport { Router } from '@angular/router';\nimport { AuthService } from '../auth.service'; // Asegúrate de importar tu AuthService\n\n@Component({\n  selector: 'app-productos',\n  templateUrl: './productos.component.html',\n  styleUrls: ['./productos.component.css']\n})\nexport class ProductosComponent implements OnInit {\n  scrollPosition = 0;\n  productos: any[] = [];\n  newProducto: any = {};\n  editingProducto: any = null;\n  selectedFile: File | null = null; \n  error = '';\n  filter: string = '';\n  private apiUrl = 'http://localhost:3000/api/productos';\n\n  constructor(\n    private productoService: ProductoService, \n    private router: Router,\n    private authService: AuthService // Asegúrate de inyectar tu AuthService\n  ) { }\n\n  ngOnInit(): void {\n    this.loadProductos();\n  }\n\n  loadProductos(): void {\n    this.productoService.getProductos().subscribe(\n      data => {\n        this.productos = data;\n      },\n      err => {\n        console.error('Error obteniendo productos:', err);\n        this.error = 'Error en el servidor al obtener productos.';\n      }\n    );\n  }\n\n  isJavier(): boolean {\n    return this.authService.getCurrentUser() === 'javier';\n  }\n\n  onFileChange(event: Event): void {\n    const element = event.target as HTMLInputElement;\n    if (element.files && element.files.length > 0) {\n      this.newProducto.imagen_pro = element.files[0];\n    }\n  }\n\n  createProducto(): void {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para crear productos');\n      return;\n    }\n    this.productoService.createProducto(this.newProducto).subscribe(\n      data => {\n        this.productos.push(data);\n        this.newProducto = {};\n        this.router.navigate(['productos']);\n      },\n      err => {\n        console.error('Error creando producto:', err);\n        this.error = 'Error en el servidor al crear producto.';\n      }\n    );\n  }\n\n  editProducto(producto: any): void {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para editar productos');\n      return;\n    }\n    this.editingProducto = { ...producto };\n  }\n\n  updateProducto(comp_id: number): void {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para actualizar productos');\n      return;\n    }\n    if (this.selectedFile && !this.editingProducto.imagen_pro) {\n      this.productoService.uploadImagen(this.selectedFile).subscribe(\n        response => {\n          this.editingProducto.imagen_pro = response.imageUrl;\n          this.saveUpdatedProducto(comp_id);\n        },\n        error => {\n          console.error('Error al cargar la imagen:', error);\n        }\n      );\n    } else {\n      this.saveUpdatedProducto(comp_id);\n    }\n  }\n\n  saveUpdatedProducto(comp_id: number): void {\n    this.productoService.updateProducto(comp_id, this.editingProducto).subscribe(\n      data => {\n        const index = this.productos.findIndex(p => p.comp_id === comp_id);\n        if (index !== -1) {\n          this.productos[index] = data;\n        }\n        this.editingProducto = null;\n      },\n      err => {\n        console.error('Error actualizando producto:', err);\n        this.error = 'Error en el servidor al actualizar producto.';\n      }\n    );\n  }\n\n  deleteProducto(id: number): void {\n    if (!this.isJavier()) {\n      console.error('No tienes permiso para eliminar productos');\n      return;\n    }\n    if (id) {\n      this.productoService.deleteProducto(id).subscribe(\n        data => {\n          this.productos = this.productos.filter(p => p.comp_id !== id);\n          this.router.navigate(['productos']);\n        },\n        err => {\n          console.error('Error eliminando producto:', err);\n          this.error = 'Error en el servidor al eliminar producto.';\n        }\n      );\n    } else {\n      console.error('No se encontró el producto:', id);\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}